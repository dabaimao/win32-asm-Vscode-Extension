{
    "scopeName":"source.asm",
    "patterns":[
        {"include":"#string"},
        {"include":"#comment"},
        {"include":"#register"},
        {"include":"#instructionSet"},
        {"include":"#pseudocodeForMASM"}
    ],
    "repository":{

        "string":{
            "match":"(\\'.*\\')|(\".*\")",
            "name":"string.other.link"
        },
        "comment":{
            "match":";.*\n",
            "name":"comment"
        },
        "register":{
            "patterns":[{"include":"#baseRegister"}]
        },

        "baseRegister":{
            "patterns":[
                {"include":"#generalPurposeRegister64"},
                {"include":"#generalPurposeRegister32"},
                {"include":"#generalPurposeRegister16"},
                {"include":"#generalPurposeRegister8"},
                {"include":"#segmentRegister"}
            ],
            "name":"register"
        },
        "generalPurposeRegister64":{
            "match":"(?<!\\.)\\b(?i)(?:rax|rbx|rcx|rdx|rsi|rdi|rbp|rsp|(r(8|9|10|11|12|13|14|15)))\\b",
            "name":"register"

        },
        "generalPurposeRegister32":{
            "match":"(?<!\\.)\\b(?i)(?:eax|ebx|ecx|edx|esi|edi|ebp|esp|(r(8|9|10|11|12|13|14|15)d))\\b",
            "name":"register"
        },
        "generalPurposeRegister16":{
            "match":"(?<!\\.)\\b(?i)(?:ax|bx|cx|dx|si|di|bp|sp|(r(8|9|10|11|12|13|14|15)w))\\b",
            "name":"register"
        },
        "generalPurposeRegister8":{
            "match":"(?<!\\.)\\b(?i)(?:(a|b|c|d|)[hl]|sil|dil|bpl|spl|(r(8|9|10|11|12|13|14|15)l))\\b",
            "name":"register"
        },
        "segmentRegister":{
            "match":"(?<!\\.)\\b(?i)(?:(?:c|d|s|e|f|g)s)\\b",
            "name":"register"
        },


"//00":"处理器指令着色",

        "instructionSet":{
            "patterns":[
                {"include":"#generalPurposeInstructions"},
                {"include":"#x87FPUInstructions"},
                {"include":"#mMXInstructions"},
                {"include":"#sSEInstructions"},
                {"include":"#sSE2Instructions"},
                {"include":"#sSE3Instructions"},
                {"include":"#sSSE3"},
                {"include":"#sSE4.1.4.2Instructions"},
                {"include":"#aESNIANDPCLMULQDQ"},
                {"include":"#iNTELTRANSACTIONALSYNCHRONIZATIONEXTENSIONSINTELTSX"},
                {"include":"#iNTELSHAEXTENSIONS"},
                {"include":"#AVX512"},
                {"include":"#systemInstructions"},
                {"include":"#64bitmodeInstructions"},
                {"include":"#VMX"},
                {"include":"#SMX"},
                {"include":"#MPX"},
                {"include":"#SGX"}
            ]
        },
"//01":"通用处理器指令着色",
        "generalPurposeInstructions":{
            "patterns":[
                {"include":"#dataTransferInstructions"},
                {"include":"#binaryArthmeticInstructions"},
                {"include":"#decimalArithmeticInstructions"},
                {"include":"#logicalInstructions"},
                {"include":"#shiftandRotateInstructions"},
                {"include":"#bitandByteInstructions"},
                {"include":"#controlTransferInstructions"},
                {"include":"#stringInstructions"},
                {"include":"#inputOutputInstructions"},
                {"include":"#enterAndLeaveInstructions"},
                {"include":"#segmentRegisterInstructions"},
                {"include":"#miscellaneousInstructions"},
                {"include":"#userModeExtendedSateSaveRestoreInstructions"},
                {"include":"#randomNumberGeneratorInstructions"},
                {"include":"#bMI1BMI2"}
            ],
            "name":"instruction"
        },
        "dataTransferInstructions":{
            "match":"(?<!\\.)\\b(?i)(?:mov|cmove|cmovz|cmovne|cmovnz|cmova|cmovnbe|cmovae|cmovnb|cmovb|cmovnae|cmovbe|cmovna|cmovg|cmovnle|cmovge|cmovnl|cmovl|cmovnge|cmovle|cmovng|cmovc|cmovnc|cmovo|cmovno|cmovs|cmovns|cmovp|cmovpe|cmovnp|cmovpo|xchg|bswap|xadd|cmpxchg|cmpxchg8b|push|pop|pusha|pushad|popa|popad|cwd|cdq|cbw|cwde|movsx|movzx)\\b",
            "name":"instruction"
        },
        "binaryArthmeticInstructions":{
            "match":"(?<!\\.)\\b(?i)(?:adcx|adox|add|adc|sub|sbb|imul|mul|idiv|div|inc|dec|neg|cmp)\\b",
            "name":"instruction"
        },
        "decimalArithmeticInstructions":{
            "match":"(?<!\\.)\\b(?i)(?:daa|das|aaa|aas|aam|aad)\\b",
            "name":"instruction"
        },
        "logicalInstructions":{
            "match":"(?<!\\.)\\b(?i)(and|or|xor|not)\\b",
            "name":"instruction"
        },
        "shiftandRotateInstructions":{
            "match":"(?<!\\.)\\b(?i)(sar|shr|sal|shl|shrd|shld|ror|rol|rcr|rcl)\\b",
            "name":"instruction"
        },
        "bitandByteInstructions":{
            "match":"(?<!\\.)\\b(?i)(bt|bts|btr|btc|bsf|bsr|sete|setz|setne|setnz|seta|setnbe|setae|setnb|setnc|setb|setnae|setc|setbe|setna|setg|setnle|setge|setnl|setl|setnge|setle|setng|sets|setns|seto|setno|setpe|setp|setpo|setnp|test|crc32|popcnt)\\b",
            "name":"instruction"
        },
        "controlTransferInstructions":{
            "match":"(?<!\\.)\\b(?i)(jmp|je|jz|jne|jnz|ja|jnbe|jae|jnb|jb|jnae|jbe|jna|jg|jnle|jge|jnl|jl|jnge|jle|jng|jc|jnc|jo|jno|js|jns|jpo|jnp|jpe|jp|jcxz|jecxz|loop|loopz|loope|loopnz|loopne|call|ret|iret|int|into|bound|enter|leave)\\b",
            "name":"instruction"
        },
        "stringInstructions":{
            "match":"(?<!\\.)\\b(?i)(movs|movsb|movsw|movsd|cmps|cmpsb|cmpsw|cmpsd|scas|scasb|scasw|scasd|lods|lodsb|lodsw|lodsd|stos|stosb|stosw|stosd|rep|repe/repz|repne/repnz)\\b",
            "name":"instruction"
        },
        "inputOutputInstructions":{
            "match":"(?<!\\.)\\b(?i)(in|out|ins|insb|ins|insw|ins|insd|outs|outsb|outsw|outsd)\\b",
            "name":"instruction"
        },
        "enterAndLeaveInstructions":{
            "match":"(?<!\\.)\\b(?i)(stc|clc|cmc|cld|std|lahflsahf|pushf|pushfd|popf|popfd|sti|cli)\\b",
            "name":"instruction"
        },
        "segmentRegisterInstructions":{
            "match":"(?<!\\.)\\b(?i)(lds|les|lfs|lgs|lss)\\b",
            "name":"instruction"
        },
        "miscellaneousInstructions":{
            "match":"(?<!\\.)\\b(?i)(lea|nop|ukxlat|ud|xlat|xlatb|cpuid|movbe|prefetchw|prefetchwt1|clflush|clflushopt)\\b",
            "name":"instruction"
        },
        "userModeExtendedSateSaveRestoreInstructions":{
            "match":"(?<!\\.)\\b(?i)(xsave|xsavec|xsaveopt|xrstor|xgetbv)\\b",
            "name":"instruction"
        },
        "randomNumberGeneratorInstructions":{
            "match":"(?<!\\.)\\b(?i)(rd(rand|seed))\\b",
            "name":"instruction"
        },
        "bMI1BMI2":{
            "match":"(?<!\\.)\\b(?i)(andn|bextr|blsi|blsmsk|blsr|bzhi|lzcnt|mulx|pdep|pext|rorx|sarx|shlx|shrx|tzcnt)\\b",
            "name":"instruction"
        },

"//02":"x87浮点处理器指令着色",
        "x87FPUInstructions":{
            "patterns":[
                {"include":"#x87FPUDataTransferInstructions"},
                {"include":"#x87FPUBasicArithmeticInstructions"},
                {"include":"#x87FPUComparisonInstructions"},
                {"include":"#x87FPUTranscendentalInstructions"},
                {"include":"#x87FPULoadConstantsInstructions"},
                {"include":"#x87FPUControlInstructions"},
                {"include":"#x87FPUandSimdStateManagementInstructions"}
            ]
        },
        "x87FPUDataTransferInstructions":{
            "match":"(?<!\\.)\\b(?i)(fi??ld|fi??st|fstp|fist|fistp|fbld|fbstp|fxch|fcmove|fcmovne|fcmovb|fcmovbe|fcmovnb|fcmovnbe|fcmovu|fcmovnu)\\b",
            "name":"instruction"
        },
        "x87FPUBasicArithmeticInstructions":{
            "match":"(?<!\\.)\\b(?i)(fadd|faddp|fiadd|fsub|fsubp|fisub|fsubr|fsubrp|fisubr|fmul|fmulp|fimul|fdiv|fdivp|fidiv|fdivr|fdivrp|fidivr|fprem|fprem1|fabs|fchs|frndint|fscale|fsqrt|fxtract)\\b",
            "name":"instruction"
        },
        "x87FPUComparisonInstructions":{
            "match":"(?<!\\.)\\b(?i)(fcom|fcomp|fcompp|fucom|fucomp|fucompp|ficom|ficomp|fcomi|fucomi|fcomip|fucomip|ftst|fxam)\\b",
            "name":"instruction"
        },
        "x87FPUTranscendentalInstructions":{
            "match":"(?<!\\.)\\b(?i)(fsin|fcos|fsincos|fptan|fpatan|f2xm1|fyl2x|fyl2xp1)\\b",
            "name":"instruction"
        },
        "x87FPULoadConstantsInstructions":{
            "match":"(?<!\\.)\\b(?i)(fld1|fldz|fldpi|fldl2e|fldln2|fldl2t|fldlg2)\\b",
            "name":"instruction"
        },
        "x87FPUControlInstructions":{
            "match":"(?<!\\.)\\b(?i)(fincstp|fdecstp|ffree|finit|fninit|fclex|fnclex|fstcw|fnstcw|fldcw|fstenv|fnstenv|fldenv|fsave|fnsave|frstor|fstsw|fnstsw|wait|fwait|fnop)\\b",
            "name":"instruction"
        },
        "x87FPUandSimdStateManagementInstructions":{
            "match":"(?<!\\.)\\b(?i)(fxsave|fxrstor)\\b",
            "name":"instruction"
        },
"//03":"MMX指令着色",
        "mMXInstructions":{
            "patterns":[
                    {"include":"#mMXDataTransferInstructions"},
                    {"include":"#mMXConversionInstructions"},
                    {"include":"#mMXPackedArithmeticInstructions"},
                    {"include":"#mMXComparisonInstructions"},
                    {"include":"#mMXLogicalInstructions"},
                    {"include":"#mMXShiftandRotateInstructions"},
                    {"include":"#mMXStateManagementInstructions"}
            ]
        },
        "mMXDataTransferInstructions": {
            "match":"(?<!\\.)\\b(?i)(movd|movq)\\b",
            "name":"instruction"
        },
        "mMXConversionInstructions":{
            "match":"(?<!\\.)\\b(?i)(packsswb|packssdw|packuswb|punpckhbw|punpckhwd|punpckhdq|punpcklbw|punpcklwd|punpckldq)\\b",
            "name":"instruction"
        },
        "mMXPackedArithmeticInstructions":{
            "match":"(?<!\\.)\\b(?i)(paddb|paddw|paddd|paddsb|paddsw|paddusb|paddusw|psubb|psubw|psubd|psubsb|psubsw|psubusb|psubusw|pmulhw|pmullw|pmaddwd)\\b",
            "name":"instruction"
        },
        "mMXComparisonInstructions":{
            "match":"(?<!\\.)\\b(?i)(pcmpeqb|pcmpeqw|pcmpeqd|pcmpgtb|pcmpgtw|pcmpgtd)\\b",
            "name":"instruction"
        },
        "mMXLogicalInstructions":{
            "match":"(?<!\\.)\\b(?i)(pandn??|pxor??)\\b",
            "name":"instruction"
        },
        "mMXShiftandRotateInstructions":{
            "match":"(?<!\\.)\\b(?i)(psllw|pslld|psllq|psrlw|psrld|psrlq|psraw|psrad)\\b",
            "name":"instruction"
        },
        "mMXStateManagementInstructions":{
            "match":"(?<!\\.)\\b(?i)(emms)\\b",
            "name":"instruction"
        },
"//04":"SSE指令着色",
        "sSEInstructions":{
            "patterns":[
                {"include":"#sSESIMDSinglePrecisionFloatingPointInstructions"},
                {"include":"#sSEMXCSRStateManagementInstructions"},
                {"include":"#sSE64-BitSIMDIntegerInstructions"},
                {"include":"#sSECacheabilityControlPrefetchAndInstructionOrderingInstructions"}
            ]
        },

        "sSESIMDSinglePrecisionFloatingPointInstructions":{
            "patterns":[
                {"include":"#sSEDataTransferInstructions"},
                {"include":"#sSEPackedArithmeticInstructions"},
                {"include":"#sSEComparisonInstructions"},
                {"include":"#sSELogicalInstructions"},
                {"include":"#sSEShuffleandUnpackInstructions"},
                {"include":"#sSEConversionInstructions"}
            ]
        },
        "sSEDataTransferInstructions":{
            "match":"(?<!\\.)\\b(?i)mov(aps|ups|hps|hlps|lps|lhps|mskps|ss)\\b",
            "name":"instruction"
        },
        "sSEPackedArithmeticInstructions":{
            "match":"(?<!\\.)\\b(?i)(add|sub|mul|div|rcp|sqrt|rsqrt|max|min)(ss|ps)\\b",
            "name":"instruction"
        },
        "sSEComparisonInstructions":{
            "match":"(?<!\\.)\\b(?i)cmp(ps|ss)|u??comiss\\b",
            "name":"instruction"
        },
        "sSELogicalInstructions":{
            "match":"(?<!\\.)\\b(?i)(andn??|x??or)ps\\b",
            "name":"instruction"
        },
        "sSEShuffleandUnpackInstructions":{
            "match":"(?<!\\.)\\b(?i)(shufps|unpckhps|unpcklps)\\b",
            "name":"instruction"
        },
        "sSEConversionInstructions":{
            "match":"(?<!\\.)\\b(?i)(cvtpi2ps|cvtsi2ss|cvtps2pi|cvttps2pi|cvtss2si|cvttss2si)\\b",
            "name":"instruction"
        },
        "sSEMXCSRStateManagementInstructions":{
            "match":"(?<!\\.)\\b(?i)(ld|st)mxcsr\\b",
            "name":"instruction"
        },
        "sSE64-BitSIMDIntegerInstructions":{
            "match":"(?<!\\.)\\b(?i)(pavgb|pavgw|pextrw|pinsrw|pmaxub|pmaxsw|pminub|pminsw|pmovmskb|pmulhuw|psadbw|pshufw)\\b",
            "name":"instruction"
        },
        "sSECacheabilityControlPrefetchAndInstructionOrderingInstructions":{
            "match":"(?<!\\.)\\b(?i)(maskmovq|movntq|movntps|prefetch(0|1|2|3|nta)|sfence)\\b",
            "name":"instruction"
        },
"//05":"SSE2指集着色",
        "sSE2Instructions":{
            "patterns":[
                {"include":"#sSE2PackedandScalar"},
                {"include":"#sSE2PackedSinglePrecisionFloatingPointInstructions"},
                {"include":"#sSE2128BitSIMDIntegerInstructions"},
                {"include":"#sSE2CacheabilityControlandOrderingInstructions"}
            ]
        },
        "sSE2PackedandScalar":{
            "patterns":[
                {"include":"#sSE2DataMovementInstructions"},
                {"include":"#sSE2PackedArithmeticInstructions"},
                {"include":"#sSE2LogicalInstructions"},
                {"include":"#sSE2CompareInstructions"},
                {"include":"#sSE2ShuffleandUnpackInstructions"},
                {"include":"#sSE2ConversionInstructions"}
            ]
        },
        "sSE2DataMovementInstructions":{
            "match":"(?<!\\.)\\b(?i)(mov(apd|upd|hpd|lpd|mskpd|ds))\\b",
            "name":"instruction"
        },
        "sSE2PackedArithmeticInstructions":{
            "match":"(?<!\\.)\\b(?i)(add|sub|mul|div|sqrt|max|min)(pd|sd)\\b",
            "name":"instruction"
        },
        "sSE2LogicalInstructions":{
            "match":"(?<!\\.)\\b(?i)(andn??|x??or)pd\\b",
            "name":"instruction"
        },
        "sSE2CompareInstructions":{
            "match":"(?<!\\.)\\b(?i)(cmppd|cmpsd|comisd|ucomisd)\\b",
            "name":"instruction"
        },
        "sSE2ShuffleandUnpackInstructions":{
            "match":"(?<!\\.)\\b(?i)(shufpd|unpckhpd|unpcklpd)\\b",
            "name":"instruction"
        },
        "sSE2ConversionInstructions":{
            "match":"(?<!\\.)\\b(?i)cvt(pd2pi|tpd2pi|pi2pd|pd2dq|tpd2dq|dq2pd|ps2pd|pd2ps|ss2sd|sd2ss|sd2si|tsd2si|si2sd)\\b",
            "name":"instruction"
        },
        "sSE2PackedSinglePrecisionFloatingPointInstructions":{
            "match":"(?<!\\.)\\b(?i)cvt(dq2ps|ps2dq|tps2dq)\\b",
            "name":"instruction"
        },

        "sSE2128BitSIMDIntegerInstructions":{
            "match":"(?<!\\.)\\b(?i)(movdqa|movdqu|movq2dq|movdq2q|pmuludq|paddq|psubq|pshuflw|pshufhw|pshufd|pslldq|psrldq|punpckhqdq|punpcklqdq)\\b",
            "name":"instruction"
        },

        "sSE2CacheabilityControlandOrderingInstructions":{
            "match":"(?<!\\.)\\b(?i)(clflush|lfence|mfence|pause|maskmovdqu|movntpd|movntdq|movnti)\\b",
            "name":"instruction"
        },
"//06":"SSE3指令集着色",
        "sSE3Instructions":{
            "patterns":[
                {"include":"#sSE3x87FPIntegerConversionInstruction"},
                {"include":"#sSE3Specialized128bitUnalignedDataLoadInstruction"},
                {"include":"#sSE3SIMDFloatingPointPackedADDSUBInstructions"},
                {"include":"#sSE3SIMDFloatingPointHorizontalADDSUBInstructions"},
                {"include":"#sSE3SIMDFloatingPointLOADMOVEDUPLICATEInstructions"},
                {"include":"#sSE3AgentSynchronizationInstructions"}
            ]
        },
        "sSE3x87FPIntegerConversionInstruction":{
            "match":"(?<!\\.)\\b(?i)(fisttp)\\b",
            "name":"instruction"
        },
        "sSE3Specialized128bitUnalignedDataLoadInstruction":{
            "match":"(?<!\\.)\\b(?i)(lddqu)\\b",
            "name":"instruction"
        },
        "sSE3SIMDFloatingPointPackedADDSUBInstructions":{
            "match":"(?<!\\.)\\b(?i)addsubp(s|d)\\b",
            "name":"instruction"
        },
        "sSE3SIMDFloatingPointHorizontalADDSUBInstructions":{
            "match":"(?<!\\.)\\b(?i)h(add|sub)(ps|pd)\\b",
            "name":"instruction"
        },
        "sSE3SIMDFloatingPointLOADMOVEDUPLICATEInstructions":{
            "match":"(?<!\\.)\\b(?i)mov(sh|sl|d)dup\\b",
            "name":"instruction"
        },
        "sSE3AgentSynchronizationInstructions":{
            "match":"(?<!\\.)\\b(?i)(monitor|mwait)\\b",
            "name":"instruction"
        },

"//07":"SSSE3指令集着色",
        "sSSE3":{
            "match":"(?<!\\.)\\b(?i)(ph(add|sub)(w|sw|d)|pabs(b|w|d)|pmaddubsw|pmulhrsw|pshufb|psign(b|w|d)|palignr)\\b",
            "name":"instruction"
        },
"//09":"sSE4.1.4.2指令集着色",
        "sSE4.1.4.2Instructions":{
            "match":"(?<!\\.)\\b(?i)(pmulld|pumldq|dppd|dpps|movntdqa|blend(v??(pd|ps))|pblend(vb|w)|pmin(uw|ud|sb|sd)|(pmin|pmax)(uw|ud|sb|sd)|round(ps|pd|ss|sd)|extractps|insertps|pins(rb|rd|rq)|pextr(b|w|d|q)|pmov(sxbw|zxbw|sxbd|zxbd|sxwd|zxwd|sxbq|zxbq|sxwq|zxwq|sxdq|zxdq)|mpsadbw|phminposuw|ptest|pcmpeqq|packusdw|(pcmp(estr|istr))(i|m)|pcmpgtq)\\b",
            "name":"instruction"
        },

"//11":"AESNI指令集着色",
        "aESNIANDPCLMULQDQ":{
            "match":"(?<!\\.)\\b(?i)(aes((dec|enc)last??|imc|keygenassist)|pclmulqdq)\\b",
            "name":"instruction"
        },
"//16":"INTEL TSX",
        "iNTELTRANSACTIONALSYNCHRONIZATIONEXTENSIONSINTELTSX":{
            "match":"(?<!\\.)\\b(?i)x(abort|acquire|release|begin|end|test)\\b",
            "name":"instruction"
        },
"//17":"INTEL SHA EXTENSIONS",
        "iNTELSHAEXTENSIONS":{
            "match":"(?<!\\.)\\b(?i)sha(1msg(1|2)|1nexte|1rnds4|256(msg(1|2)|rnds2))\\b",
            "name":"instruction"
        },

"//18":"INTEL® ADVANCED VECTOR EXTENSIONS 512 (INTEL® AVX-512)",
        "AVX512":{
            "match":"(?<!\\.)\\b(?i)(vblendm|vcompress|vcvtqq2)(pd|ps)|vcvtt??(p(d|s)2udq|s(d|s)2usi)|(vcvtudq2|vexpand)(pd|ps)|vcvtusi2us(d|s)|(vextractf|vextracti|vinsertf)((32|64)x4)|(vfixupimm|vgetexp|vgetmant|vrcp14|vrndscale|vrsqrt14|vscale|vrange|vreduce|vexp2|vrcp28|vrsqrt28|vfpclass)(pd|ps|sd|ss)|(vmovdqa|vmovdqu)(32|64)|(vpblendm|vpbroadcast|vpcompress|vpexpand|valign|vprol|vprolv|vpror|vprorr|vptestnm|vpterlog|vptestm|vpconflict|vplzcnt|vpmovm2)(d|q)|vpcm(pd|ud|pq|uq)|(vpermi2|vpermt2)(d|q|pd|ps)|(vpmax|vpmin)(sq|ud|uq)|vpmov(s|us)(qb|qw|qd|db|dw)|(vpscatter|vscatter)(dd|dq|qd|qq)|vpsraq|vpsravq|vshuf(f|i)(32x4|64x2)|vcvtt??(pd|ps)(2qq|2uqq)|vcvtuqq2(pd|ps)|(vextract|vinsert)(f|i)64x2|vpmov(b2d|q2m)|vpmullq|vdbpsadbw|vmovdqu(8|16)|vpcm(pb|ub|pw|uw)|vpermw|(vpblendm|vpbroadcast|vpermi2|vpmovm2|vptestnm|vptestm)(b|w)|vpmov(b2m|w2m)|vpmov(s|us)wb|(vpsll|vpsra|vpsrl)vw|vpbroadcastm|(kadd|kand|kandn|kmov|knot|kor|kortest|kshiftl|kshiftr|ktest|kxnor|kxor)(b|w|d|q)|kunpck(bw|wd|dq)|(vgatherpf|vscatterpf)(0|1)(d|q)(pd|ps)\\b",
            "name":"instruction"
        },
"//19":"SYSTEM INSTRUCTIONS指令集着色",
        "systemInstructions":{
            "match":"(?<!\\.)\\b(?i)(clac|stac|lgdt|sgdt|lldt|sldt|ltr|str|lidt|sidt|mov|lmsw|smsw|clts|arpl|lar|lsl|verr|verw|mov|invd|wbinvd|invlpg|invpcid|lock|hlt|rsm|rdmsr|wrmsr|rdpmc|rdtsc|rdtscp|sysenter|sysexit|x(save(c|opt|s)|rstors??|(get|set)bv)|(rd|wr)(fs|gs)base)\\b",
            "name":"instruction"
        },
"//20":"64bitmodeInstructions",
        "64bitmodeInstructions":{
            "match":"(?<!\\.)\\b(?i)(cdqe|cmpsq|cmpxchg16b|lodsq|movsq|movzx|stosq|swapgs|syscall|sysret)\\b",
            "name":"instruction"
        },
"//21":"VIRTUAL-MACHINE EXTENSIONS",
        "VMX":{
            "match":"(?<!\\.)\\b(?i)(vmptrld|vmptrst|vmclear|vmread|vmwrite|vmlaunch|vmresume|vmxoff|vmxon|vmcall|vmfunc|invept|invvpid)\\b",
            "name":"instruction"
        },
"//22":"SAFER MODE EXTENSIONS",
        "SMX":{
            "match":"(?<!\\.)\\b(?i)getsec\\b",
            "name":"instruction"
        },
"//23":"INTEL® MEMORY PROTECTION EXTENSIONS",
        "MPX":{
            "match":"(?<!\\.)\\b(?i)bnd(mk|cl|cu|cn|mov|ldx|stx)\\b",
            "name":"instruction"
        },
"//24":"INTEL® SOFTWARE GUARD EXTENSIONS",
        "SGX":{
            "match":"(?<!\\.)\\b(?i)encl[s|u]\\b",
            "name":"instruction"
        },
"//ML.EXE ":"Pseudocode For MASM",

        "pseudocodeForMASM":{
            "name":"instruction",
            "patterns":[
                {"include":"#x64"},
                {"include":"#codeLabels"},
                {"include":"#conditionalAssembly"},
                {"include":"#conditionalControlFlow"},
                {"include":"#conditionalError"},
                {"include":"#dataAllocation"},
                {"include":"#equates"},
                {"include":"#listingControl"},
                {"include":"#macros"},
                {"include":"#miscellaneous"},
                {"include":"#procedures"},
                {"include":"#processor"},
                {"include":"#repeatBlocks"},
                {"include":"#scope"},
                {"include":"#segment"},
                {"include":"#simplifiedSegment"},
                {"include":"#stringMASM"},
                {"include":"#structureAndRecord"},
                {"include":"#boolean"},
                {"include":"#modelParameter"},
                {"include":"#optionParameter"},
                {"include":"#predefineSymbol"},
                {"include":"#predefConst"},
                {"include":"#test"},
                {"include":"#immediateOperandDisplayColor"}
            ]
        },


        "x64":{
            "match":"(?i)(\\bproc|\\B\\.(allocstack|endprolog|push(frame|reg)|save(reg|xmm128)|setframe))\\b",
            "name":"instruction"
        },
        "codeLabels":{
            "match":"(?i)(\\b(align|even|label|org)\\b)|\\B\\%out\\b",
            "name":"instruction"
        },
        "conditionalAssembly":{
            "match":"(?i)\\b((else(if2??)??)|if(2|n??b|n??def|e|difi??|idni??)??)\\b",
            "name":"instruction"
        },
        "conditionalControlFlow":{
            "match":"(?i)\\B(\\.(break|continue|repeat|while|if|else(if)??|until(cxz)??|end(if|w)))\\b",
            "name":"instruction"
        },
        "conditionalError":{
            "match":"(?i)\\B\\.(err(2|b|def|difi??|e|idni??|n(b|def|z))??)\\b",
            "name":"instruction"
        },
        "dataAllocation":{
            "match":"\\b(?i)((s??(byte|d??word)|(f|q|o|sq)word|real(4|8|10)|tbyte)|d(b|d|f|q|t|w))\\b",
            "name":"keyword"
        },
        "equates":{
            "match":"\\b(?i)((text)??equ)\\b",
            "name":"instruction"
        },
        "listingControl":{
            "match":"(?i)(\\B\\.((l|s|x)all|(t|l|s)fcond|(no)??(x??cref|x??list(all|if|macro(all)??)??))\\b)|(\\b(page|sub(title|ttl)|title)\\b)",
            "name":"instruction"
        },
        "macros":{
            "match":"\\b(?i)(endm|exitm|goto|local|macro|purge|name)\\b",
            "name":"instruction"
        },
        "miscellaneous":{
            "match":"(?i)((\\B\\.(fpo|radix|safeseh))|\\b(alias|assume|comment|echo|end|include(lib)??|mmword|option|(pop|push)context|(x|y)mmword))\\b",
            "name":"instruction"
        },
        "procedures":{
            "match":"\\b(?i)(endp|invoke|proto)\\b",
            "name":"instruction"
        },
        "processor":{
            "match":"\\B(?i)\\.(386p??|387|486p??|586p??|686p??|k3d|mmx|xmm)\\b",
            "name":"instruction"
        },
        "repeatBlocks":{
            "match":"\\b(?i)((irp|for)c??|rep(ea)??t|while)\\b",
            "name":"instruction"
        },
        "scope":{
            "match":"\\b(?i)(comm|extrn|extern(def)??|public)\\b",
            "name":"instruction"
        },
        "segment":{
            "match":"(?i)(\\B\\.(alpha|dosseg|seq)|\\b(assume|ends|group|segment|dosseg))\\b",
            "name":"instruction"
        },
        "simplifiedSegment":{
            "match":"(?i)\\B\\.((far)??data\\?\\B|(code|const|data|exit|model|(far)??data|stack|startup)\\b)",
            "name":"instruction"
        },
        "stringMASM":{
            "match":"(?i)\\b((cat|in|size|sub)str)\\b",
            "name":"instruction"
        },
        "structureAndRecord":{
            "match":"\\b(?i)(record|struct??|typedef|union)\\b",
            "name":"instruction"
        },
        "boolean":{
            "match":"(?<!\\.)\\b(?i)(true|null|false)\\b",
            "name":"entity.other.attribute-name.class"
        },
        "modelParameter": {
            "match":"(?<!\\.)\\b(?i)(tiny|small|compact|medium|large|huge|flat|c|basic|fortran|pascal|(sys|std)call)\\b",
            "name":"source.sass keyword.control"
        },
        "optionParameter":{
            "match":"(?i)(?<=option)\\s+\\b(casemap|(no)??dotname|(no)??emulator|epilogue|expr(16|32)|language|(no)??ljmp|(no)??m510|nokeyword|nosignextend|offset|(no)??oldmacros|(no)??oldstructs|pro(c|logue)|(no)??readonly|(no)??scoped|segment|setif2\\.)+\\b",
            "name":"source.sass keyword.control"
        },
        "predefineSymbol": {
            "match":"\\B(\\@((\\@\\:|fardata\\?)\\B|(B|(Cat|Size|In|Sub)Str|code|Cpu|CurSeg|data|(Code|Data|Word)Size|Date|Environ|F|fardata|File(Cur|Name)|Interface|Line|Model|stack|Time|Version)\\b)|(\\$|\\?)\\B)",
            "name":"constant.other.symbol"
        },
        "immediateOperandDisplayColor":{
            "match":"\\b\\h{4}h\\b",
            "name":"immediate.operand.hex"
        }
    }
}